# Codex-Claude Proxy Integration
# Source this in your ~/.zshrc: source ~/Documents/ì—ì´ì „íŠ¸/infiniteAgent/self-evolving-agent-system/.zshrc-codex-proxy

# Claude Code with Codex models (í”„ë¡ì‹œ ìë™ ì‹œì‘, ëª¨ë¸ ì •ì²´ì„± ê³µê°œ)
ccy() {
  # ê¸°ì¡´ í”„ë¡ì‹œ ì¢…ë£Œ í›„ REVEAL ëª¨ë“œë¡œ ì¬ì‹œì‘
  if lsof -i:8082 -P | grep -q LISTEN; then
    lsof -ti:8082 | xargs kill -9 2>/dev/null
    sleep 1
  fi

  echo "ğŸš€ Starting Codex proxy (REVEAL_ACTUAL_MODEL=true)..."
  (cd /Users/seohun/Documents/codex-claude-proxy && REVEAL_ACTUAL_MODEL=true .venv/bin/python server.py &>/dev/null &)
  sleep 2

  # Claude Code ì‹¤í–‰ (ë‹¨ì¼ ëª¨ë¸ ê°•ì œ)
  ANTHROPIC_AUTH_TOKEN="sk-proxy-codex" \
  ANTHROPIC_BASE_URL=http://localhost:8082 \
  ANTHROPIC_MODEL=claude-sonnet-4-5-20250929 \
  claude --dangerously-skip-permissions "$@"
}

# í”„ë¡ì‹œ ê´€ë¦¬
codex-proxy-start() {
  cd /Users/seohun/Documents/codex-claude-proxy && .venv/bin/python server.py &
  echo "âœ… Proxy started on port 8082"
}

codex-proxy-stop() {
  lsof -ti:8082 | xargs kill -9 2>/dev/null && echo "ğŸ›‘ Proxy stopped" || echo "âš ï¸  Proxy not running"
}

codex-proxy-status() {
  if lsof -i:8082 -P | grep -q LISTEN; then
    echo "âœ… Proxy running on port 8082"
  else
    echo "âŒ Proxy not running"
  fi
}

# ë‹¨ì¶• ëª…ë ¹ì–´
alias cpstop='codex-proxy-stop'
