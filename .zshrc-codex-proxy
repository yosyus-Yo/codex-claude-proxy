# Codex-Claude Proxy Integration
# Source this in your ~/.zshrc: source ~/Documents/ì—ì´ì „íŠ¸/infiniteAgent/self-evolving-agent-system/.zshrc-codex-proxy

# Claude Code with Codex models (í”„ë¡ì‹œ ìë™ ì‹œì‘)
ccy() {
  # í”„ë¡ì‹œê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
  if ! lsof -i:8082 -P | grep -q LISTEN; then
    echo "ğŸš€ Starting Codex proxy..."
    (cd /Users/seohun/Documents/codex-claude-proxy && .venv/bin/python server.py &>/dev/null &)
    sleep 2
  fi

  # Claude Code ì‹¤í–‰
  ANTHROPIC_AUTH_TOKEN="sk-proxy-codex" \
  ANTHROPIC_BASE_URL=http://localhost:8082 \
  claude --dangerously-skip-permissions "$@"
}

# Codex ëª¨ë¸ ì •ì²´ì„± ê³µê°œ ë²„ì „ (gpt-5.3-codexë¡œ ìì‹ ì„ ì†Œê°œ)
ccy-reveal() {
  # ê¸°ì¡´ í”„ë¡ì‹œ ì¢…ë£Œ í›„ REVEAL ëª¨ë“œë¡œ ì¬ì‹œì‘
  lsof -ti:8082 | xargs kill -9 2>/dev/null
  echo "ğŸš€ Starting Codex proxy with REVEAL_ACTUAL_MODEL..."
  (cd /Users/seohun/Documents/codex-claude-proxy && REVEAL_ACTUAL_MODEL=true .venv/bin/python server.py &>/dev/null &)
  sleep 2

  # Claude Code ì‹¤í–‰
  ANTHROPIC_AUTH_TOKEN="sk-proxy-codex" \
  ANTHROPIC_BASE_URL=http://localhost:8082 \
  claude --dangerously-skip-permissions "$@"
}

# í”„ë¡ì‹œ ê´€ë¦¬
codex-proxy-start() {
  cd /Users/seohun/Documents/codex-claude-proxy && .venv/bin/python server.py &
  echo "âœ… Proxy started on port 8082"
}

codex-proxy-stop() {
  lsof -ti:8082 | xargs kill -9 2>/dev/null && echo "ğŸ›‘ Proxy stopped" || echo "âš ï¸  Proxy not running"
}

codex-proxy-status() {
  if lsof -i:8082 -P | grep -q LISTEN; then
    echo "âœ… Proxy running on port 8082"
  else
    echo "âŒ Proxy not running"
  fi
}

# ë‹¨ì¶• ëª…ë ¹ì–´
alias cpstop='codex-proxy-stop'
